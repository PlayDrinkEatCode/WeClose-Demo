"use strict";(self.webpackChunkwepie_activity=self.webpackChunkwepie_activity||[]).push([["762"],{17520:function(t,e,n){n.r(e),n.d(e,{connect:function(){return tj},WebTransport:function(){return tu},io:function(){return tj},Manager:function(){return tq},WebSocket:function(){return ta},NodeWebSocket:function(){return ta},Socket:function(){return tx},NodeXHR:function(){return tn},Fetch:function(){return t_},XHR:function(){return tn},default:function(){return tj},protocol:function(){return tT}});var r,i,o,s,a,u={};n.r(u),n.d(u,{Decoder:function(){return tC},Encoder:function(){return tO},PacketType:function(){return a},protocol:function(){return tT}});var c=n(42607),h=n(83965),f=n(79444),l=n(35111),p=n(31808),d=n(81803),y=n(27674),v=n(91729),_=Object.create(null);_.open="0",_.close="1",_.ping="2",_.pong="3",_.message="4",_.upgrade="5",_.noop="6";var g=Object.create(null);Object.keys(_).forEach(function(t){g[_[t]]=t});var k={type:"error",data:"parser error"},m="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===Object.prototype.toString.call(Blob),b="function"==typeof ArrayBuffer,w=function(t){return"function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(t):t&&t.buffer instanceof ArrayBuffer},E=function(t,e,n){var r=t.type,i=t.data;return m&&i instanceof Blob?e?n(i):A(i,n):b&&(i instanceof ArrayBuffer||w(i))?e?n(i):A(new Blob([i]),n):n(_[r]+(i||""))},A=function(t,e){var n=new FileReader;return n.onload=function(){e("b"+(n.result.split(",")[1]||""))},n.readAsDataURL(t)};function T(t){return t instanceof Uint8Array?t:t instanceof ArrayBuffer?new Uint8Array(t):new Uint8Array(t.buffer,t.byteOffset,t.byteLength)}for(var O="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",R="undefined"==typeof Uint8Array?[]:new Uint8Array(256),C=0;C<O.length;C++)R[O.charCodeAt(C)]=C;var B=function(t){var e,n,r,i,o,s=.75*t.length,a=t.length,u=0;"="===t[t.length-1]&&(s--,"="===t[t.length-2]&&s--);var c=new ArrayBuffer(s),h=new Uint8Array(c);for(e=0;e<a;e+=4)n=R[t.charCodeAt(e)],r=R[t.charCodeAt(e+1)],i=R[t.charCodeAt(e+2)],o=R[t.charCodeAt(e+3)],h[u++]=n<<2|r>>4,h[u++]=(15&r)<<4|i>>2,h[u++]=(3&i)<<6|63&o;return c},S="function"==typeof ArrayBuffer,N=function(t,e){if("string"!=typeof t)return{type:"message",data:L(t,e)};var n=t.charAt(0);return"b"===n?{type:"message",data:x(t.substring(1),e)}:g[n]?t.length>1?{type:g[n],data:t.substring(1)}:{type:g[n]}:k},x=function(t,e){return S?L(B(t),e):{base64:!0,data:t}},L=function(t,e){return"blob"===e?t instanceof Blob?t:new Blob([t]):t instanceof ArrayBuffer?t:t.buffer},q=function(t,e){var n=t.length,r=Array(n),i=0;t.forEach(function(t,o){E(t,!1,function(t){r[o]=t,++i===n&&e(r.join("\x1e"))})})},P=function(t,e){for(var n=t.split("\x1e"),r=[],i=0;i<n.length;i++){var o=N(n[i],e);if(r.push(o),"error"===o.type)break}return r};function j(t){return t.reduce(function(t,e){return t+e.length},0)}function D(t,e){if(t[0].length===e)return t.shift();for(var n=new Uint8Array(e),r=0,i=0;i<e;i++)n[i]=t[0][r++],r===t[0].length&&(t.shift(),r=0);return t.length&&r<t[0].length&&(t[0]=t[0].slice(r)),n}function U(t){if(t)return function(t){for(var e in U.prototype)t[e]=U.prototype[e];return t}(t)}U.prototype.on=U.prototype.addEventListener=function(t,e){return this._callbacks=this._callbacks||{},(this._callbacks["$"+t]=this._callbacks["$"+t]||[]).push(e),this},U.prototype.once=function(t,e){function n(){this.off(t,n),e.apply(this,arguments)}return n.fn=e,this.on(t,n),this},U.prototype.off=U.prototype.removeListener=U.prototype.removeAllListeners=U.prototype.removeEventListener=function(t,e){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var n,r=this._callbacks["$"+t];if(!r)return this;if(1==arguments.length)return delete this._callbacks["$"+t],this;for(var i=0;i<r.length;i++)if((n=r[i])===e||n.fn===e){r.splice(i,1);break}return 0===r.length&&delete this._callbacks["$"+t],this},U.prototype.emit=function(t){this._callbacks=this._callbacks||{};for(var e=Array(arguments.length-1),n=this._callbacks["$"+t],r=1;r<arguments.length;r++)e[r-1]=arguments[r];if(n){n=n.slice(0);for(var r=0,i=n.length;r<i;++r)n[r].apply(this,e)}return this},U.prototype.emitReserved=U.prototype.emit,U.prototype.listeners=function(t){return this._callbacks=this._callbacks||{},this._callbacks["$"+t]||[]},U.prototype.hasListeners=function(t){return!!this.listeners(t).length};var F="function"==typeof Promise&&"function"==typeof Promise.resolve?function(t){return Promise.resolve().then(t)}:function(t,e){return e(t,0)},I="undefined"!=typeof self?self:"undefined"!=typeof window?window:Function("return this")();function M(t){for(var e=arguments.length,n=Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return n.reduce(function(e,n){return t.hasOwnProperty(n)&&(e[n]=t[n]),e},{})}var V=I.setTimeout,H=I.clearTimeout;function W(t,e){e.useNativeTimers?(t.setTimeoutFn=V.bind(I),t.clearTimeoutFn=H.bind(I)):(t.setTimeoutFn=I.setTimeout.bind(I),t.clearTimeoutFn=I.clearTimeout.bind(I))}function K(){return Date.now().toString(36).substring(3)+Math.random().toString(36).substring(2,5)}var Y=function(t){function e(t,n,r){var i;return(0,f._)(this,e),(i=(0,h._)(this,e,[t])).description=n,i.context=r,i.type="TransportError",i}return(0,y._)(e,t),e}((0,v._)(Error)),z=function(t){function e(t){var n;return(0,f._)(this,e),(n=(0,h._)(this,e)).writable=!1,W(n,t),n.opts=t,n.query=t.query,n.socket=t.socket,n.supportsBinary=!t.forceBase64,n}return(0,y._)(e,t),(0,l._)(e,[{key:"onError",value:function(t,n,r){return(0,p._)((0,d._)(e.prototype),"emitReserved",this).call(this,"error",new Y(t,n,r)),this}},{key:"open",value:function(){return this.readyState="opening",this.doOpen(),this}},{key:"close",value:function(){return("opening"===this.readyState||"open"===this.readyState)&&(this.doClose(),this.onClose()),this}},{key:"send",value:function(t){"open"===this.readyState&&this.write(t)}},{key:"onOpen",value:function(){this.readyState="open",this.writable=!0,(0,p._)((0,d._)(e.prototype),"emitReserved",this).call(this,"open")}},{key:"onData",value:function(t){var e=N(t,this.socket.binaryType);this.onPacket(e)}},{key:"onPacket",value:function(t){(0,p._)((0,d._)(e.prototype),"emitReserved",this).call(this,"packet",t)}},{key:"onClose",value:function(t){this.readyState="closed",(0,p._)((0,d._)(e.prototype),"emitReserved",this).call(this,"close",t)}},{key:"pause",value:function(t){}},{key:"createUri",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t+"://"+this._hostname()+this._port()+this.opts.path+this._query(e)}},{key:"_hostname",value:function(){var t=this.opts.hostname;return -1===t.indexOf(":")?t:"["+t+"]"}},{key:"_port",value:function(){return this.opts.port&&(this.opts.secure&&Number(443!==this.opts.port)||!this.opts.secure&&80!==Number(this.opts.port))?":"+this.opts.port:""}},{key:"_query",value:function(t){var e=function(t){var e="";for(var n in t)t.hasOwnProperty(n)&&(e.length&&(e+="&"),e+=encodeURIComponent(n)+"="+encodeURIComponent(t[n]));return e}(t);return e.length?"?"+e:""}}]),e}(U),J=function(t){function e(){var t;return(0,f._)(this,e),t=(0,h._)(this,e,arguments),t._polling=!1,t}return(0,y._)(e,t),(0,l._)(e,[{key:"name",get:function(){return"polling"}},{key:"doOpen",value:function(){this._poll()}},{key:"pause",value:function(t){var e=this;this.readyState="pausing";var n=function(){e.readyState="paused",t()};if(this._polling||!this.writable){var r=0;this._polling&&(r++,this.once("pollComplete",function(){--r||n()})),this.writable||(r++,this.once("drain",function(){--r||n()}))}else n()}},{key:"_poll",value:function(){this._polling=!0,this.doPoll(),this.emitReserved("poll")}},{key:"onData",value:function(t){var e=this;P(t,this.socket.binaryType).forEach(function(t){if("opening"===e.readyState&&"open"===t.type&&e.onOpen(),"close"===t.type)return e.onClose({description:"transport closed by the server"}),!1;e.onPacket(t)}),"closed"!==this.readyState&&(this._polling=!1,this.emitReserved("pollComplete"),"open"===this.readyState&&this._poll())}},{key:"doClose",value:function(){var t=this,e=function(){t.write([{type:"close"}])};"open"===this.readyState?e():this.once("open",e)}},{key:"write",value:function(t){var e=this;this.writable=!1,q(t,function(t){e.doWrite(t,function(){e.writable=!0,e.emitReserved("drain")})})}},{key:"uri",value:function(){var t=this.opts.secure?"https":"http",e=this.query||{};return!1!==this.opts.timestampRequests&&(e[this.opts.timestampParam]=K()),this.supportsBinary||e.sid||(e.b64=1),this.createUri(t,e)}}]),e}(z),X=!1;try{X="undefined"!=typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}catch(t){}var $=X;function Q(){}var G=function(t){function e(t){if((0,f._)(this,e),n=(0,h._)(this,e,[t]),"undefined"!=typeof location){var n,r="https:"===location.protocol,i=location.port;i||(i=r?"443":"80"),n.xd="undefined"!=typeof location&&t.hostname!==location.hostname||i!==t.port}return n}return(0,y._)(e,t),(0,l._)(e,[{key:"doWrite",value:function(t,e){var n=this,r=this.request({method:"POST",data:t});r.on("success",e),r.on("error",function(t,e){n.onError("xhr post error",t,e)})}},{key:"doPoll",value:function(){var t=this,e=this.request();e.on("data",this.onData.bind(this)),e.on("error",function(e,n){t.onError("xhr poll error",e,n)}),this.pollXhr=e}}]),e}(J),Z=function(t){function e(t,n,r){var i;return(0,f._)(this,e),(i=(0,h._)(this,e)).createRequest=t,W(i,r),i._opts=r,i._method=r.method||"GET",i._uri=n,i._data=void 0!==r.data?r.data:null,i._create(),i}return(0,y._)(e,t),(0,l._)(e,[{key:"_create",value:function(){var t,n=this,r=M(this._opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");r.xdomain=!!this._opts.xd;var i=this._xhr=this.createRequest(r);try{i.open(this._method,this._uri,!0);try{if(this._opts.extraHeaders)for(var o in i.setDisableHeaderCheck&&i.setDisableHeaderCheck(!0),this._opts.extraHeaders)this._opts.extraHeaders.hasOwnProperty(o)&&i.setRequestHeader(o,this._opts.extraHeaders[o])}catch(t){}if("POST"===this._method)try{i.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(t){}try{i.setRequestHeader("Accept","*/*")}catch(t){}null===(t=this._opts.cookieJar)||void 0===t||t.addCookies(i),"withCredentials"in i&&(i.withCredentials=this._opts.withCredentials),this._opts.requestTimeout&&(i.timeout=this._opts.requestTimeout),i.onreadystatechange=function(){var t;3===i.readyState&&(null===(t=n._opts.cookieJar)||void 0===t||t.parseCookies(i.getResponseHeader("set-cookie"))),4===i.readyState&&(200===i.status||1223===i.status?n._onLoad():n.setTimeoutFn(function(){n._onError("number"==typeof i.status?i.status:0)},0))},i.send(this._data)}catch(t){this.setTimeoutFn(function(){n._onError(t)},0);return}"undefined"!=typeof document&&(this._index=e.requestsCount++,e.requests[this._index]=this)}},{key:"_onError",value:function(t){this.emitReserved("error",t,this._xhr),this._cleanup(!0)}},{key:"_cleanup",value:function(t){if(void 0!==this._xhr&&null!==this._xhr){if(this._xhr.onreadystatechange=Q,t)try{this._xhr.abort()}catch(t){}"undefined"!=typeof document&&delete e.requests[this._index],this._xhr=null}}},{key:"_onLoad",value:function(){var t=this._xhr.responseText;null!==t&&(this.emitReserved("data",t),this.emitReserved("success"),this._cleanup())}},{key:"abort",value:function(){this._cleanup()}}]),e}(U);function tt(){for(var t in Z.requests)Z.requests.hasOwnProperty(t)&&Z.requests[t].abort()}Z.requestsCount=0,Z.requests={},"undefined"!=typeof document&&("function"==typeof attachEvent?attachEvent("onunload",tt):"function"==typeof addEventListener&&addEventListener("onpagehide"in I?"pagehide":"unload",tt,!1));var te=(r=tr({xdomain:!1}))&&null!==r.responseType,tn=function(t){function e(t){(0,f._)(this,e),n=(0,h._)(this,e,[t]);var n,r=t&&t.forceBase64;return n.supportsBinary=te&&!r,n}return(0,y._)(e,t),(0,l._)(e,[{key:"request",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object.assign(t,{xd:this.xd},this.opts),new Z(tr,this.uri(),t)}}]),e}(G);function tr(t){var e=t.xdomain;try{if("undefined"!=typeof XMLHttpRequest&&(!e||$))return new XMLHttpRequest}catch(t){}if(!e)try{return new I[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch(t){}}var ti="undefined"!=typeof navigator&&"string"==typeof navigator.product&&"reactnative"===navigator.product.toLowerCase(),to=function(t){function e(){return(0,f._)(this,e),(0,h._)(this,e,arguments)}return(0,y._)(e,t),(0,l._)(e,[{key:"name",get:function(){return"websocket"}},{key:"doOpen",value:function(){var t=this.uri(),e=this.opts.protocols,n=ti?{}:M(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(n.headers=this.opts.extraHeaders);try{this.ws=this.createSocket(t,e,n)}catch(t){return this.emitReserved("error",t)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}},{key:"addEventListeners",value:function(){var t=this;this.ws.onopen=function(){t.opts.autoUnref&&t.ws._socket.unref(),t.onOpen()},this.ws.onclose=function(e){return t.onClose({description:"websocket connection closed",context:e})},this.ws.onmessage=function(e){return t.onData(e.data)},this.ws.onerror=function(e){return t.onError("websocket error",e)}}},{key:"write",value:function(t){var e,n=this;this.writable=!1;for(var r=0;r<t.length;r++)e=this,function(r){var i=t[r],o=r===t.length-1;E(i,e.supportsBinary,function(t){try{n.doWrite(i,t)}catch(t){}o&&F(function(){n.writable=!0,n.emitReserved("drain")},n.setTimeoutFn)})}(r)}},{key:"doClose",value:function(){void 0!==this.ws&&(this.ws.onerror=function(){},this.ws.close(),this.ws=null)}},{key:"uri",value:function(){var t=this.opts.secure?"wss":"ws",e=this.query||{};return this.opts.timestampRequests&&(e[this.opts.timestampParam]=K()),this.supportsBinary||(e.b64=1),this.createUri(t,e)}}]),e}(z),ts=I.WebSocket||I.MozWebSocket,ta=function(t){function e(){return(0,f._)(this,e),(0,h._)(this,e,arguments)}return(0,y._)(e,t),(0,l._)(e,[{key:"createSocket",value:function(t,e,n){return ti?new ts(t,e,n):e?new ts(t,e):new ts(t)}},{key:"doWrite",value:function(t,e){this.ws.send(e)}}]),e}(to),tu=function(t){function e(){return(0,f._)(this,e),(0,h._)(this,e,arguments)}return(0,y._)(e,t),(0,l._)(e,[{key:"name",get:function(){return"webtransport"}},{key:"doOpen",value:function(){var t=this;try{this._transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name])}catch(t){return this.emitReserved("error",t)}this._transport.closed.then(function(){t.onClose()}).catch(function(e){t.onError("webtransport error",e)}),this._transport.ready.then(function(){t._transport.createBidirectionalStream().then(function(e){var n,r,i,a,u,c,h=(n=Number.MAX_SAFE_INTEGER,r=t.socket.binaryType,s||(s=new TextDecoder),i=[],a=0,u=-1,c=!1,new TransformStream({transform:function(t,e){for(i.push(t);;){if(0===a){if(1>j(i))break;var o=D(i,1);c=(128&o[0])==128,a=(u=127&o[0])<126?3:126===u?1:2}else if(1===a){if(2>j(i))break;var h=D(i,2);u=new DataView(h.buffer,h.byteOffset,h.length).getUint16(0),a=3}else if(2===a){if(8>j(i))break;var f=D(i,8),l=new DataView(f.buffer,f.byteOffset,f.length),p=l.getUint32(0);if(p>2097151){e.enqueue(k);break}u=0x100000000*p+l.getUint32(4),a=3}else{if(j(i)<u)break;var d=D(i,u);e.enqueue(N(c?d:s.decode(d),r)),a=0}if(0===u||u>n){e.enqueue(k);break}}}})),f=e.readable.pipeThrough(h).getReader(),l=new TransformStream({transform:function(t,e){var n;n=function(n){var r,i=n.length;if(i<126)new DataView((r=new Uint8Array(1)).buffer).setUint8(0,i);else if(i<65536){var o=new DataView((r=new Uint8Array(3)).buffer);o.setUint8(0,126),o.setUint16(1,i)}else{var s=new DataView((r=new Uint8Array(9)).buffer);s.setUint8(0,127),s.setBigUint64(1,BigInt(i))}t.data&&"string"!=typeof t.data&&(r[0]|=128),e.enqueue(r),e.enqueue(n)},m&&t.data instanceof Blob?t.data.arrayBuffer().then(T).then(n):b&&(t.data instanceof ArrayBuffer||w(t.data))?n(T(t.data)):E(t,!1,function(t){o||(o=new TextEncoder),n(o.encode(t))})}});l.readable.pipeTo(e.writable),t._writer=l.writable.getWriter();var p=function(){f.read().then(function(e){var n=e.done,r=e.value;!n&&(t.onPacket(r),p())}).catch(function(t){})};p();var d={type:"open"};t.query.sid&&(d.data='{"sid":"'.concat(t.query.sid,'"}')),t._writer.write(d).then(function(){return t.onOpen()})})})}},{key:"write",value:function(t){var e,n=this;this.writable=!1;for(var r=0;r<t.length;r++)e=this,function(r){var i=t[r],o=r===t.length-1;e._writer.write(i).then(function(){o&&F(function(){n.writable=!0,n.emitReserved("drain")},n.setTimeoutFn)})}(r)}},{key:"doClose",value:function(){var t;null===(t=this._transport)||void 0===t||t.close()}}]),e}(z),tc={websocket:ta,webtransport:tu,polling:tn},th=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,tf=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function tl(t){if(t.length>8e3)throw"URI too long";var e,n,r,i,o,s,a=t,u=t.indexOf("["),c=t.indexOf("]");-1!=u&&-1!=c&&(t=t.substring(0,u)+t.substring(u,c).replace(/:/g,";")+t.substring(c,t.length));for(var h=th.exec(t||""),f={},l=14;l--;)f[tf[l]]=h[l]||"";return -1!=u&&-1!=c&&(f.source=a,f.host=f.host.substring(1,f.host.length-1).replace(/;/g,":"),f.authority=f.authority.replace("[","").replace("]","").replace(/;/g,":"),f.ipv6uri=!0),f.pathNames=(e=0,r=(n=f.path).replace(/\/{2,9}/g,"/").split("/"),("/"==n.slice(0,1)||0===n.length)&&r.splice(0,1),"/"==n.slice(-1)&&r.splice(r.length-1,1),r),f.queryKey=(i=0,o=f.query,s={},o.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(t,e,n){e&&(s[e]=n)}),s),f}var tp="function"==typeof addEventListener&&"function"==typeof removeEventListener,td=[];tp&&addEventListener("offline",function(){td.forEach(function(t){return t()})},!1);var ty=function(t){function e(t,n){if((0,f._)(this,e),(r=(0,h._)(this,e)).binaryType="arraybuffer",r.writeBuffer=[],r._prevBufferLen=0,r._pingInterval=-1,r._pingTimeout=-1,r._maxPayload=-1,r._pingTimeoutTime=1/0,t&&"object"===(void 0===t?"undefined":(0,c._)(t))&&(n=t,t=null),t){var r,i=tl(t);n.hostname=i.host,n.secure="https"===i.protocol||"wss"===i.protocol,n.port=i.port,i.query&&(n.query=i.query)}else n.host&&(n.hostname=tl(n.host).host);return W(r,n),r.secure=null!=n.secure?n.secure:"undefined"!=typeof location&&"https:"===location.protocol,n.hostname&&!n.port&&(n.port=r.secure?"443":"80"),r.hostname=n.hostname||("undefined"!=typeof location?location.hostname:"localhost"),r.port=n.port||("undefined"!=typeof location&&location.port?location.port:r.secure?"443":"80"),r.transports=[],r._transportsByName={},n.transports.forEach(function(t){var e=t.prototype.name;r.transports.push(e),r._transportsByName[e]=t}),r.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},n),r.opts.path=r.opts.path.replace(/\/$/,"")+(r.opts.addTrailingSlash?"/":""),"string"==typeof r.opts.query&&(r.opts.query=function(t){for(var e={},n=t.split("&"),r=0,i=n.length;r<i;r++){var o=n[r].split("=");e[decodeURIComponent(o[0])]=decodeURIComponent(o[1])}return e}(r.opts.query)),tp&&(r.opts.closeOnBeforeunload&&(r._beforeunloadEventListener=function(){r.transport&&(r.transport.removeAllListeners(),r.transport.close())},addEventListener("beforeunload",r._beforeunloadEventListener,!1)),"localhost"!==r.hostname&&(r._offlineEventListener=function(){r._onClose("transport close",{description:"network connection lost"})},td.push(r._offlineEventListener))),r.opts.withCredentials&&(r._cookieJar=void 0),r._open(),r}return(0,y._)(e,t),(0,l._)(e,[{key:"createTransport",value:function(t){var e=Object.assign({},this.opts.query);e.EIO=4,e.transport=t,this.id&&(e.sid=this.id);var n=Object.assign({},this.opts,{query:e,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[t]);return new this._transportsByName[t](n)}},{key:"_open",value:function(){var t=this;if(0===this.transports.length){this.setTimeoutFn(function(){t.emitReserved("error","No transports available")},0);return}var n=this.opts.rememberUpgrade&&e.priorWebsocketSuccess&&-1!==this.transports.indexOf("websocket")?"websocket":this.transports[0];this.readyState="opening";var r=this.createTransport(n);r.open(),this.setTransport(r)}},{key:"setTransport",value:function(t){var e=this;this.transport&&this.transport.removeAllListeners(),this.transport=t,t.on("drain",this._onDrain.bind(this)).on("packet",this._onPacket.bind(this)).on("error",this._onError.bind(this)).on("close",function(t){return e._onClose("transport close",t)})}},{key:"onOpen",value:function(){this.readyState="open",e.priorWebsocketSuccess="websocket"===this.transport.name,this.emitReserved("open"),this.flush()}},{key:"_onPacket",value:function(t){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)switch(this.emitReserved("packet",t),this.emitReserved("heartbeat"),t.type){case"open":this.onHandshake(JSON.parse(t.data));break;case"ping":this._sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong"),this._resetPingTimeout();break;case"error":var e=Error("server error");e.code=t.data,this._onError(e);break;case"message":this.emitReserved("data",t.data),this.emitReserved("message",t.data)}}},{key:"onHandshake",value:function(t){this.emitReserved("handshake",t),this.id=t.sid,this.transport.query.sid=t.sid,this._pingInterval=t.pingInterval,this._pingTimeout=t.pingTimeout,this._maxPayload=t.maxPayload,this.onOpen(),"closed"!==this.readyState&&this._resetPingTimeout()}},{key:"_resetPingTimeout",value:function(){var t=this;this.clearTimeoutFn(this._pingTimeoutTimer);var e=this._pingInterval+this._pingTimeout;this._pingTimeoutTime=Date.now()+e,this._pingTimeoutTimer=this.setTimeoutFn(function(){t._onClose("ping timeout")},e),this.opts.autoUnref&&this._pingTimeoutTimer.unref()}},{key:"_onDrain",value:function(){this.writeBuffer.splice(0,this._prevBufferLen),this._prevBufferLen=0,0===this.writeBuffer.length?this.emitReserved("drain"):this.flush()}},{key:"flush",value:function(){if("closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){var t=this._getWritablePackets();this.transport.send(t),this._prevBufferLen=t.length,this.emitReserved("flush")}}},{key:"_getWritablePackets",value:function(){if(!(this._maxPayload&&"polling"===this.transport.name&&this.writeBuffer.length>1))return this.writeBuffer;for(var t=1,e=0;e<this.writeBuffer.length;e++){var n=this.writeBuffer[e].data;if(n&&(t+="string"==typeof n?function(t){for(var e=0,n=0,r=0,i=t.length;r<i;r++)(e=t.charCodeAt(r))<128?n+=1:e<2048?n+=2:e<55296||e>=57344?n+=3:(r++,n+=4);return n}(n):Math.ceil(1.33*(n.byteLength||n.size))),e>0&&t>this._maxPayload)return this.writeBuffer.slice(0,e);t+=2}return this.writeBuffer}},{key:"_hasPingExpired",value:function(){var t=this;if(!this._pingTimeoutTime)return!0;var e=Date.now()>this._pingTimeoutTime;return e&&(this._pingTimeoutTime=0,F(function(){t._onClose("ping timeout")},this.setTimeoutFn)),e}},{key:"write",value:function(t,e,n){return this._sendPacket("message",t,e,n),this}},{key:"send",value:function(t,e,n){return this._sendPacket("message",t,e,n),this}},{key:"_sendPacket",value:function(t,e,n,r){if("function"==typeof e&&(r=e,e=void 0),"function"==typeof n&&(r=n,n=null),"closing"!==this.readyState&&"closed"!==this.readyState){(n=n||{}).compress=!1!==n.compress;var i={type:t,data:e,options:n};this.emitReserved("packetCreate",i),this.writeBuffer.push(i),r&&this.once("flush",r),this.flush()}}},{key:"close",value:function(){var t=this,e=function(){t._onClose("forced close"),t.transport.close()},n=function(){t.off("upgrade",n),t.off("upgradeError",n),e()},r=function(){t.once("upgrade",n),t.once("upgradeError",n)};return("opening"===this.readyState||"open"===this.readyState)&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",function(){t.upgrading?r():e()}):this.upgrading?r():e()),this}},{key:"_onError",value:function(t){if(e.priorWebsocketSuccess=!1,this.opts.tryAllTransports&&this.transports.length>1&&"opening"===this.readyState)return this.transports.shift(),this._open();this.emitReserved("error",t),this._onClose("transport error",t)}},{key:"_onClose",value:function(t,e){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState){if(this.clearTimeoutFn(this._pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),tp&&(this._beforeunloadEventListener&&removeEventListener("beforeunload",this._beforeunloadEventListener,!1),this._offlineEventListener)){var n=td.indexOf(this._offlineEventListener);-1!==n&&td.splice(n,1)}this.readyState="closed",this.id=null,this.emitReserved("close",t,e),this.writeBuffer=[],this._prevBufferLen=0}}}]),e}(U);ty.protocol=4;var tv=function(t){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,f._)(this,e);var r=(void 0===t?"undefined":(0,c._)(t))==="object"?t:n;return(!r.transports||r.transports&&"string"==typeof r.transports[0])&&(r.transports=(r.transports||["polling","websocket","webtransport"]).map(function(t){return tc[t]}).filter(function(t){return!!t})),(0,h._)(this,e,[t,r])}return(0,y._)(e,t),e}(function(t){function e(){var t;return(0,f._)(this,e),t=(0,h._)(this,e,arguments),t._upgrades=[],t}return(0,y._)(e,t),(0,l._)(e,[{key:"onOpen",value:function(){if((0,p._)((0,d._)(e.prototype),"onOpen",this).call(this),"open"===this.readyState&&this.opts.upgrade)for(var t=0;t<this._upgrades.length;t++)this._probe(this._upgrades[t])}},{key:"_probe",value:function(t){var e=this,n=this.createTransport(t),r=!1;ty.priorWebsocketSuccess=!1;var i=function(){r||(n.send([{type:"ping",data:"probe"}]),n.once("packet",function(t){if(!r){if("pong"===t.type&&"probe"===t.data)e.upgrading=!0,e.emitReserved("upgrading",n),n&&(ty.priorWebsocketSuccess="websocket"===n.name,e.transport.pause(function(){!r&&"closed"!==e.readyState&&(h(),e.setTransport(n),n.send([{type:"upgrade"}]),e.emitReserved("upgrade",n),n=null,e.upgrading=!1,e.flush())}));else{var i=Error("probe error");i.transport=n.name,e.emitReserved("upgradeError",i)}}}))};function o(){r||(r=!0,h(),n.close(),n=null)}var s=function(t){var r=Error("probe error: "+t);r.transport=n.name,o(),e.emitReserved("upgradeError",r)};function a(){s("transport closed")}function u(){s("socket closed")}function c(t){n&&t.name!==n.name&&o()}var h=function(){n.removeListener("open",i),n.removeListener("error",s),n.removeListener("close",a),e.off("close",u),e.off("upgrading",c)};n.once("open",i),n.once("error",s),n.once("close",a),this.once("close",u),this.once("upgrading",c),-1!==this._upgrades.indexOf("webtransport")&&"webtransport"!==t?this.setTimeoutFn(function(){r||n.open()},200):n.open()}},{key:"onHandshake",value:function(t){this._upgrades=this._filterUpgrades(t.upgrades),(0,p._)((0,d._)(e.prototype),"onHandshake",this).call(this,t)}},{key:"_filterUpgrades",value:function(t){for(var e=[],n=0;n<t.length;n++)~this.transports.indexOf(t[n])&&e.push(t[n]);return e}}]),e}(ty)),t_=function(t){function e(){return(0,f._)(this,e),(0,h._)(this,e,arguments)}return(0,y._)(e,t),(0,l._)(e,[{key:"doPoll",value:function(){var t=this;this._fetch().then(function(e){if(!e.ok)return t.onError("fetch read error",e.status,e);e.text().then(function(e){return t.onData(e)})}).catch(function(e){t.onError("fetch read error",e)})}},{key:"doWrite",value:function(t,e){var n=this;this._fetch(t).then(function(t){if(!t.ok)return n.onError("fetch write error",t.status,t);e()}).catch(function(t){n.onError("fetch write error",t)})}},{key:"_fetch",value:function(t){var e,n=this,r=void 0!==t,i=new Headers(this.opts.extraHeaders);return r&&i.set("content-type","text/plain;charset=UTF-8"),null===(e=this.socket._cookieJar)||void 0===e||e.appendCookies(i),fetch(this.uri(),{method:r?"POST":"GET",body:r?t:null,headers:i,credentials:this.opts.withCredentials?"include":"omit"}).then(function(t){var e;return null===(e=n.socket._cookieJar)||void 0===e||e.parseCookies(t.headers.getSetCookie()),t})}}]),e}(J);tv.protocol;var tg=n(10277),tk="function"==typeof ArrayBuffer,tm=Object.prototype.toString,tb="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===tm.call(Blob),tw="function"==typeof File||"undefined"!=typeof File&&"[object FileConstructor]"===tm.call(File);function tE(t){return tk&&(t instanceof ArrayBuffer||("function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(t):t.buffer instanceof ArrayBuffer))||tb&&t instanceof Blob||tw&&t instanceof File}var tA=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"],tT=5;(i=a||(a={}))[i.CONNECT=0]="CONNECT",i[i.DISCONNECT=1]="DISCONNECT",i[i.EVENT=2]="EVENT",i[i.ACK=3]="ACK",i[i.CONNECT_ERROR=4]="CONNECT_ERROR",i[i.BINARY_EVENT=5]="BINARY_EVENT",i[i.BINARY_ACK=6]="BINARY_ACK";var tO=function(){function t(e){(0,f._)(this,t),this.replacer=e}return(0,l._)(t,[{key:"encode",value:function(t){return(t.type===a.EVENT||t.type===a.ACK)&&function t(e,n){if(!e||(void 0===e?"undefined":(0,c._)(e))!=="object")return!1;if(Array.isArray(e)){for(var r=0,i=e.length;r<i;r++)if(t(e[r]))return!0;return!1}if(tE(e))return!0;if(e.toJSON&&"function"==typeof e.toJSON&&1==arguments.length)return t(e.toJSON(),!0);for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)&&t(e[o]))return!0;return!1}(t)?this.encodeAsBinary({type:t.type===a.EVENT?a.BINARY_EVENT:a.BINARY_ACK,nsp:t.nsp,data:t.data,id:t.id}):[this.encodeAsString(t)]}},{key:"encodeAsString",value:function(t){var e=""+t.type;return(t.type===a.BINARY_EVENT||t.type===a.BINARY_ACK)&&(e+=t.attachments+"-"),t.nsp&&"/"!==t.nsp&&(e+=t.nsp+","),null!=t.id&&(e+=t.id),null!=t.data&&(e+=JSON.stringify(t.data,this.replacer)),e}},{key:"encodeAsBinary",value:function(t){var e,n,r=(e=[],n=t.data,t.data=function t(e,n){if(!e)return e;if(tE(e)){var r={_placeholder:!0,num:n.length};return n.push(e),r}if(Array.isArray(e)){for(var i=Array(e.length),o=0;o<e.length;o++)i[o]=t(e[o],n);return i}if((void 0===e?"undefined":(0,c._)(e))==="object"&&!(e instanceof Date)){var s={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(s[a]=t(e[a],n));return s}return e}(n,e),t.attachments=e.length,{packet:t,buffers:e}),i=this.encodeAsString(r.packet),o=r.buffers;return o.unshift(i),o}}]),t}();function tR(t){return"[object Object]"===Object.prototype.toString.call(t)}var tC=function(t){function e(t){var n;return(0,f._)(this,e),(n=(0,h._)(this,e)).reviver=t,n}return(0,y._)(e,t),(0,l._)(e,[{key:"add",value:function(t){var n;if("string"==typeof t){if(this.reconstructor)throw Error("got plaintext data when reconstructing a packet");var r=(n=this.decodeString(t)).type===a.BINARY_EVENT;r||n.type===a.BINARY_ACK?(n.type=r?a.EVENT:a.ACK,this.reconstructor=new tB(n),0===n.attachments&&(0,p._)((0,d._)(e.prototype),"emitReserved",this).call(this,"decoded",n)):(0,p._)((0,d._)(e.prototype),"emitReserved",this).call(this,"decoded",n)}else if(tE(t)||t.base64){if(this.reconstructor)(n=this.reconstructor.takeBinaryData(t))&&(this.reconstructor=null,(0,p._)((0,d._)(e.prototype),"emitReserved",this).call(this,"decoded",n));else throw Error("got binary data when not reconstructing a packet")}else throw Error("Unknown type: "+t)}},{key:"decodeString",value:function(t){var n=0,r={type:Number(t.charAt(0))};if(void 0===a[r.type])throw Error("unknown packet type "+r.type);if(r.type===a.BINARY_EVENT||r.type===a.BINARY_ACK){for(var i=n+1;"-"!==t.charAt(++n)&&n!=t.length;);var o=t.substring(i,n);if(o!=Number(o)||"-"!==t.charAt(n))throw Error("Illegal attachments");r.attachments=Number(o)}if("/"===t.charAt(n+1)){for(var s=n+1;++n&&","!==t.charAt(n)&&n!==t.length;);r.nsp=t.substring(s,n)}else r.nsp="/";var u=t.charAt(n+1);if(""!==u&&Number(u)==u){for(var c=n+1;++n;){var h=t.charAt(n);if(null==h||Number(h)!=h){--n;break}if(n===t.length)break}r.id=Number(t.substring(c,n+1))}if(t.charAt(++n)){var f=this.tryParse(t.substr(n));if(e.isPayloadValid(r.type,f))r.data=f;else throw Error("invalid payload")}return r}},{key:"tryParse",value:function(t){try{return JSON.parse(t,this.reviver)}catch(t){return!1}}},{key:"destroy",value:function(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}}],[{key:"isPayloadValid",value:function(t,e){switch(t){case a.CONNECT:return tR(e);case a.DISCONNECT:return void 0===e;case a.CONNECT_ERROR:return"string"==typeof e||tR(e);case a.EVENT:case a.BINARY_EVENT:return Array.isArray(e)&&("number"==typeof e[0]||"string"==typeof e[0]&&-1===tA.indexOf(e[0]));case a.ACK:case a.BINARY_ACK:return Array.isArray(e)}}}]),e}(U),tB=function(){function t(e){(0,f._)(this,t),this.packet=e,this.buffers=[],this.reconPack=e}return(0,l._)(t,[{key:"takeBinaryData",value:function(t){if(this.buffers.push(t),this.buffers.length===this.reconPack.attachments){var e,n,r=(e=this.reconPack,n=this.buffers,e.data=function t(e,n){if(!e)return e;if(e&&!0===e._placeholder){if("number"==typeof e.num&&e.num>=0&&e.num<n.length)return n[e.num];throw Error("illegal attachments")}if(Array.isArray(e))for(var r=0;r<e.length;r++)e[r]=t(e[r],n);else if((void 0===e?"undefined":(0,c._)(e))==="object")for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(e[i]=t(e[i],n));return e}(e.data,n),delete e.attachments,e);return this.finishedReconstruction(),r}return null}},{key:"finishedReconstruction",value:function(){this.reconPack=null,this.buffers=[]}}]),t}();function tS(t,e,n){return t.on(e,n),function(){t.off(e,n)}}var tN=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1}),tx=function(t){function e(t,n,r){var i;return(0,f._)(this,e),(i=(0,h._)(this,e)).connected=!1,i.recovered=!1,i.receiveBuffer=[],i.sendBuffer=[],i._queue=[],i._queueSeq=0,i.ids=0,i.acks={},i.flags={},i.io=t,i.nsp=n,r&&r.auth&&(i.auth=r.auth),i._opts=Object.assign({},r),i.io._autoConnect&&i.open(),i}return(0,y._)(e,t),(0,l._)(e,[{key:"disconnected",get:function(){return!this.connected}},{key:"subEvents",value:function(){if(!this.subs){var t=this.io;this.subs=[tS(t,"open",this.onopen.bind(this)),tS(t,"packet",this.onpacket.bind(this)),tS(t,"error",this.onerror.bind(this)),tS(t,"close",this.onclose.bind(this))]}}},{key:"active",get:function(){return!!this.subs}},{key:"connect",value:function(){return this.connected||(this.subEvents(),this.io._reconnecting||this.io.open(),"open"===this.io._readyState&&this.onopen()),this}},{key:"open",value:function(){return this.connect()}},{key:"send",value:function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];return e.unshift("message"),this.emit.apply(this,e),this}},{key:"emit",value:function(t){for(var e,n,r,i=arguments.length,o=Array(i>1?i-1:0),s=1;s<i;s++)o[s-1]=arguments[s];if(tN.hasOwnProperty(t))throw Error('"'+t.toString()+'" is a reserved event name');if(o.unshift(t),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(o),this;var u={type:a.EVENT,data:o};if(u.options={},u.options.compress=!1!==this.flags.compress,"function"==typeof o[o.length-1]){var c=this.ids++,h=o.pop();this._registerAckCallback(c,h),u.id=c}var f=null===(n=null===(e=this.io.engine)||void 0===e?void 0:e.transport)||void 0===n?void 0:n.writable,l=this.connected&&!(null===(r=this.io.engine)||void 0===r?void 0:r._hasPingExpired());return this.flags.volatile&&!f||(l?(this.notifyOutgoingListeners(u),this.packet(u)):this.sendBuffer.push(u)),this.flags={},this}},{key:"_registerAckCallback",value:function(t,e){var n,r=this,i=this,o=null!==(n=this.flags.timeout)&&void 0!==n?n:this._opts.ackTimeout;if(void 0===o){this.acks[t]=e;return}var s=this.io.setTimeoutFn(function(){delete r.acks[t];for(var n=0;n<r.sendBuffer.length;n++)r.sendBuffer[n].id===t&&r.sendBuffer.splice(n,1);e.call(r,Error("operation has timed out"))},o),a=function(){for(var t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];i.io.clearTimeoutFn(s),e.apply(i,n)};a.withError=!0,this.acks[t]=a}},{key:"emitWithAck",value:function(t){for(var e=this,n=arguments.length,r=Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return new Promise(function(n,i){var o=function(t,e){return t?i(t):n(e)};o.withError=!0,r.push(o),e.emit.apply(e,[t].concat((0,tg._)(r)))})}},{key:"_addToQueue",value:function(t){var e,n=this;"function"==typeof t[t.length-1]&&(e=t.pop());var r={id:this._queueSeq++,tryCount:0,pending:!1,args:t,flags:Object.assign({fromQueue:!0},this.flags)};t.push(function(t){for(var i=arguments.length,o=Array(i>1?i-1:0),s=1;s<i;s++)o[s-1]=arguments[s];if(r===n._queue[0])return null!==t?r.tryCount>n._opts.retries&&(n._queue.shift(),e&&e(t)):(n._queue.shift(),e&&e.apply(void 0,[null].concat((0,tg._)(o)))),r.pending=!1,n._drainQueue()}),this._queue.push(r),this._drainQueue()}},{key:"_drainQueue",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.connected&&0!==this._queue.length){var e=this._queue[0];(!e.pending||t)&&(e.pending=!0,e.tryCount++,this.flags=e.flags,this.emit.apply(this,e.args))}}},{key:"packet",value:function(t){t.nsp=this.nsp,this.io._packet(t)}},{key:"onopen",value:function(){var t=this;"function"==typeof this.auth?this.auth(function(e){t._sendConnectPacket(e)}):this._sendConnectPacket(this.auth)}},{key:"_sendConnectPacket",value:function(t){this.packet({type:a.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},t):t})}},{key:"onerror",value:function(t){this.connected||this.emitReserved("connect_error",t)}},{key:"onclose",value:function(t,e){this.connected=!1,delete this.id,this.emitReserved("disconnect",t,e),this._clearAcks()}},{key:"_clearAcks",value:function(){var t=this;Object.keys(this.acks).forEach(function(e){if(!t.sendBuffer.some(function(t){return String(t.id)===e})){var n=t.acks[e];delete t.acks[e],n.withError&&n.call(t,Error("socket has been disconnected"))}})}},{key:"onpacket",value:function(t){if(t.nsp===this.nsp)switch(t.type){case a.CONNECT:t.data&&t.data.sid?this.onconnect(t.data.sid,t.data.pid):this.emitReserved("connect_error",Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case a.EVENT:case a.BINARY_EVENT:this.onevent(t);break;case a.ACK:case a.BINARY_ACK:this.onack(t);break;case a.DISCONNECT:this.ondisconnect();break;case a.CONNECT_ERROR:this.destroy();var e=Error(t.data.message);e.data=t.data.data,this.emitReserved("connect_error",e)}}},{key:"onevent",value:function(t){var e=t.data||[];null!=t.id&&e.push(this.ack(t.id)),this.connected?this.emitEvent(e):this.receiveBuffer.push(Object.freeze(e))}},{key:"emitEvent",value:function(t){if(this._anyListeners&&this._anyListeners.length){var n=this._anyListeners.slice(),r=!0,i=!1,o=void 0;try{for(var s,a=n[Symbol.iterator]();!(r=(s=a.next()).done);r=!0)s.value.apply(this,t)}catch(t){i=!0,o=t}finally{try{r||null==a.return||a.return()}finally{if(i)throw o}}}(0,p._)((0,d._)(e.prototype),"emit",this).apply(this,t),this._pid&&t.length&&"string"==typeof t[t.length-1]&&(this._lastOffset=t[t.length-1])}},{key:"ack",value:function(t){var e=this,n=!1;return function(){for(var r=arguments.length,i=Array(r),o=0;o<r;o++)i[o]=arguments[o];n||(n=!0,e.packet({type:a.ACK,id:t,data:i}))}}},{key:"onack",value:function(t){var e=this.acks[t.id];"function"==typeof e&&(delete this.acks[t.id],e.withError&&t.data.unshift(null),e.apply(this,t.data))}},{key:"onconnect",value:function(t,e){this.id=t,this.recovered=e&&this._pid===e,this._pid=e,this.connected=!0,this.emitBuffered(),this.emitReserved("connect"),this._drainQueue(!0)}},{key:"emitBuffered",value:function(){var t=this;this.receiveBuffer.forEach(function(e){return t.emitEvent(e)}),this.receiveBuffer=[],this.sendBuffer.forEach(function(e){t.notifyOutgoingListeners(e),t.packet(e)}),this.sendBuffer=[]}},{key:"ondisconnect",value:function(){this.destroy(),this.onclose("io server disconnect")}},{key:"destroy",value:function(){this.subs&&(this.subs.forEach(function(t){return t()}),this.subs=void 0),this.io._destroy(this)}},{key:"disconnect",value:function(){return this.connected&&this.packet({type:a.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}},{key:"close",value:function(){return this.disconnect()}},{key:"compress",value:function(t){return this.flags.compress=t,this}},{key:"volatile",get:function(){return this.flags.volatile=!0,this}},{key:"timeout",value:function(t){return this.flags.timeout=t,this}},{key:"onAny",value:function(t){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(t),this}},{key:"prependAny",value:function(t){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(t),this}},{key:"offAny",value:function(t){if(!this._anyListeners)return this;if(t){for(var e=this._anyListeners,n=0;n<e.length;n++)if(t===e[n]){e.splice(n,1);break}}else this._anyListeners=[];return this}},{key:"listenersAny",value:function(){return this._anyListeners||[]}},{key:"onAnyOutgoing",value:function(t){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(t),this}},{key:"prependAnyOutgoing",value:function(t){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(t),this}},{key:"offAnyOutgoing",value:function(t){if(!this._anyOutgoingListeners)return this;if(t){for(var e=this._anyOutgoingListeners,n=0;n<e.length;n++)if(t===e[n]){e.splice(n,1);break}}else this._anyOutgoingListeners=[];return this}},{key:"listenersAnyOutgoing",value:function(){return this._anyOutgoingListeners||[]}},{key:"notifyOutgoingListeners",value:function(t){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){var e=this._anyOutgoingListeners.slice(),n=!0,r=!1,i=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done);n=!0)o.value.apply(this,t.data)}catch(t){r=!0,i=t}finally{try{n||null==s.return||s.return()}finally{if(r)throw i}}}}}]),e}(U);function tL(t){t=t||{},this.ms=t.min||100,this.max=t.max||1e4,this.factor=t.factor||2,this.jitter=t.jitter>0&&t.jitter<=1?t.jitter:0,this.attempts=0}tL.prototype.duration=function(){var t=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var e=Math.random(),n=Math.floor(e*this.jitter*t);t=(1&Math.floor(10*e))==0?t-n:t+n}return 0|Math.min(t,this.max)},tL.prototype.reset=function(){this.attempts=0},tL.prototype.setMin=function(t){this.ms=t},tL.prototype.setMax=function(t){this.max=t},tL.prototype.setJitter=function(t){this.jitter=t};var tq=function(t){function e(t,n){(0,f._)(this,e),(r=(0,h._)(this,e)).nsps={},r.subs=[],t&&"object"===(void 0===t?"undefined":(0,c._)(t))&&(n=t,t=void 0),(n=n||{}).path=n.path||"/socket.io",r.opts=n,W(r,n),r.reconnection(!1!==n.reconnection),r.reconnectionAttempts(n.reconnectionAttempts||1/0),r.reconnectionDelay(n.reconnectionDelay||1e3),r.reconnectionDelayMax(n.reconnectionDelayMax||5e3),r.randomizationFactor(null!==(i=n.randomizationFactor)&&void 0!==i?i:.5),r.backoff=new tL({min:r.reconnectionDelay(),max:r.reconnectionDelayMax(),jitter:r.randomizationFactor()}),r.timeout(null==n.timeout?2e4:n.timeout),r._readyState="closed",r.uri=t;var r,i,o=n.parser||u;return r.encoder=new o.Encoder,r.decoder=new o.Decoder,r._autoConnect=!1!==n.autoConnect,r._autoConnect&&r.open(),r}return(0,y._)(e,t),(0,l._)(e,[{key:"reconnection",value:function(t){return arguments.length?(this._reconnection=!!t,t||(this.skipReconnect=!0),this):this._reconnection}},{key:"reconnectionAttempts",value:function(t){return void 0===t?this._reconnectionAttempts:(this._reconnectionAttempts=t,this)}},{key:"reconnectionDelay",value:function(t){var e;return void 0===t?this._reconnectionDelay:(this._reconnectionDelay=t,null===(e=this.backoff)||void 0===e||e.setMin(t),this)}},{key:"randomizationFactor",value:function(t){var e;return void 0===t?this._randomizationFactor:(this._randomizationFactor=t,null===(e=this.backoff)||void 0===e||e.setJitter(t),this)}},{key:"reconnectionDelayMax",value:function(t){var e;return void 0===t?this._reconnectionDelayMax:(this._reconnectionDelayMax=t,null===(e=this.backoff)||void 0===e||e.setMax(t),this)}},{key:"timeout",value:function(t){return arguments.length?(this._timeout=t,this):this._timeout}},{key:"maybeReconnectOnOpen",value:function(){!this._reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()}},{key:"open",value:function(t){var e=this;if(~this._readyState.indexOf("open"))return this;this.engine=new tv(this.uri,this.opts);var n=this.engine,r=this;this._readyState="opening",this.skipReconnect=!1;var i=tS(n,"open",function(){r.onopen(),t&&t()}),o=function(n){e.cleanup(),e._readyState="closed",e.emitReserved("error",n),t?t(n):e.maybeReconnectOnOpen()},s=tS(n,"error",o);if(!1!==this._timeout){var a=this._timeout,u=this.setTimeoutFn(function(){i(),o(Error("timeout")),n.close()},a);this.opts.autoUnref&&u.unref(),this.subs.push(function(){e.clearTimeoutFn(u)})}return this.subs.push(i),this.subs.push(s),this}},{key:"connect",value:function(t){return this.open(t)}},{key:"onopen",value:function(){this.cleanup(),this._readyState="open",this.emitReserved("open");var t=this.engine;this.subs.push(tS(t,"ping",this.onping.bind(this)),tS(t,"data",this.ondata.bind(this)),tS(t,"error",this.onerror.bind(this)),tS(t,"close",this.onclose.bind(this)),tS(this.decoder,"decoded",this.ondecoded.bind(this)))}},{key:"onping",value:function(){this.emitReserved("ping")}},{key:"ondata",value:function(t){try{this.decoder.add(t)}catch(t){this.onclose("parse error",t)}}},{key:"ondecoded",value:function(t){var e=this;F(function(){e.emitReserved("packet",t)},this.setTimeoutFn)}},{key:"onerror",value:function(t){this.emitReserved("error",t)}},{key:"socket",value:function(t,e){var n=this.nsps[t];return n?this._autoConnect&&!n.active&&n.connect():(n=new tx(this,t,e),this.nsps[t]=n),n}},{key:"_destroy",value:function(t){var e=Object.keys(this.nsps),n=!0,r=!1,i=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done);n=!0){var a=o.value;if(this.nsps[a].active)return}}catch(t){r=!0,i=t}finally{try{n||null==s.return||s.return()}finally{if(r)throw i}}this._close()}},{key:"_packet",value:function(t){for(var e=this.encoder.encode(t),n=0;n<e.length;n++)this.engine.write(e[n],t.options)}},{key:"cleanup",value:function(){this.subs.forEach(function(t){return t()}),this.subs.length=0,this.decoder.destroy()}},{key:"_close",value:function(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close")}},{key:"disconnect",value:function(){return this._close()}},{key:"onclose",value:function(t,e){var n;this.cleanup(),null===(n=this.engine)||void 0===n||n.close(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",t,e),this._reconnection&&!this.skipReconnect&&this.reconnect()}},{key:"reconnect",value:function(){var t=this;if(this._reconnecting||this.skipReconnect)return this;var e=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{var n=this.backoff.duration();this._reconnecting=!0;var r=this.setTimeoutFn(function(){!e.skipReconnect&&(t.emitReserved("reconnect_attempt",e.backoff.attempts),e.skipReconnect||e.open(function(n){n?(e._reconnecting=!1,e.reconnect(),t.emitReserved("reconnect_error",n)):e.onreconnect()}))},n);this.opts.autoUnref&&r.unref(),this.subs.push(function(){t.clearTimeoutFn(r)})}}},{key:"onreconnect",value:function(){var t=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",t)}}]),e}(U),tP={};function tj(t,e){(void 0===t?"undefined":(0,c._)(t))==="object"&&(e=t,t=void 0);var n,r=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2?arguments[2]:void 0,r=t;n=n||"undefined"!=typeof location&&location,null==t&&(t=n.protocol+"//"+n.host),"string"==typeof t&&("/"===t.charAt(0)&&(t="/"===t.charAt(1)?n.protocol+t:n.host+t),/^(https?|wss?):\/\//.test(t)||(t=void 0!==n?n.protocol+"//"+t:"https://"+t),r=tl(t)),!r.port&&(/^(http|ws)$/.test(r.protocol)?r.port="80":/^(http|ws)s$/.test(r.protocol)&&(r.port="443")),r.path=r.path||"/";var i=-1!==r.host.indexOf(":")?"["+r.host+"]":r.host;return r.id=r.protocol+"://"+i+":"+r.port+e,r.href=r.protocol+"://"+i+(n&&n.port===r.port?"":":"+r.port),r}(t,(e=e||{}).path||"/socket.io"),i=r.source,o=r.id,s=r.path,a=tP[o]&&s in tP[o].nsps;return e.forceNew||e["force new connection"]||!1===e.multiplex||a?n=new tq(i,e):(tP[o]||(tP[o]=new tq(i,e)),n=tP[o]),r.query&&!e.query&&(e.query=r.queryKey),n.socket(r.path,e)}Object.assign(tj,{Manager:tq,Socket:tx,io:tj,connect:tj})}}]);